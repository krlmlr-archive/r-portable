<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>R6 and Reference class performance tests</title>


<style type="text/css">code{white-space: pre;}</style>
<link href="data:text/css,pre%20%2Eoperator%2C%0Apre%20%2Eparen%20%7B%0A%20color%3A%20rgb%28104%2C%20118%2C%20135%29%0A%7D%0A%0Apre%20%2Eliteral%20%7B%0A%20color%3A%20%23990073%0A%7D%0A%0Apre%20%2Enumber%20%7B%0A%20color%3A%20%23099%3B%0A%7D%0A%0Apre%20%2Ecomment%20%7B%0A%20color%3A%20%23998%3B%0A%20font%2Dstyle%3A%20italic%0A%7D%0A%0Apre%20%2Ekeyword%20%7B%0A%20color%3A%20%23900%3B%0A%20font%2Dweight%3A%20bold%0A%7D%0A%0Apre%20%2Eidentifier%20%7B%0A%20color%3A%20rgb%280%2C%200%2C%200%29%3B%0A%7D%0A%0Apre%20%2Estring%20%7B%0A%20color%3A%20%23d14%3B%0A%7D%0A" rel="stylesheet" type="text/css" />
<script src="data:application/x-javascript,%0Avar%20hljs%3Dnew%20function%28%29%7Bfunction%20m%28p%29%7Breturn%20p%2Ereplace%28%2F%26%2Fgm%2C%22%26amp%3B%22%29%2Ereplace%28%2F%3C%2Fgm%2C%22%26lt%3B%22%29%7Dfunction%20f%28r%2Cq%2Cp%29%7Breturn%20RegExp%28q%2C%22m%22%2B%28r%2EcI%3F%22i%22%3A%22%22%29%2B%28p%3F%22g%22%3A%22%22%29%29%7Dfunction%20b%28r%29%7Bfor%28var%20p%3D0%3Bp%3Cr%2EchildNodes%2Elength%3Bp%2B%2B%29%7Bvar%20q%3Dr%2EchildNodes%5Bp%5D%3Bif%28q%2EnodeName%3D%3D%22CODE%22%29%7Breturn%20q%7Dif%28%21%28q%2EnodeType%3D%3D3%26%26q%2EnodeValue%2Ematch%28%2F%5Cs%2B%2F%29%29%29%7Bbreak%7D%7D%7Dfunction%20h%28t%2Cs%29%7Bvar%20p%3D%22%22%3Bfor%28var%20r%3D0%3Br%3Ct%2EchildNodes%2Elength%3Br%2B%2B%29%7Bif%28t%2EchildNodes%5Br%5D%2EnodeType%3D%3D3%29%7Bvar%20q%3Dt%2EchildNodes%5Br%5D%2EnodeValue%3Bif%28s%29%7Bq%3Dq%2Ereplace%28%2F%5Cn%2Fg%2C%22%22%29%7Dp%2B%3Dq%7Delse%7Bif%28t%2EchildNodes%5Br%5D%2EnodeName%3D%3D%22BR%22%29%7Bp%2B%3D%22%5Cn%22%7Delse%7Bp%2B%3Dh%28t%2EchildNodes%5Br%5D%29%7D%7D%7Dif%28%2FMSIE%20%5B678%5D%2F%2Etest%28navigator%2EuserAgent%29%29%7Bp%3Dp%2Ereplace%28%2F%5Cr%2Fg%2C%22%5Cn%22%29%7Dreturn%20p%7Dfunction%20a%28s%29%7Bvar%20r%3Ds%2EclassName%2Esplit%28%2F%5Cs%2B%2F%29%3Br%3Dr%2Econcat%28s%2EparentNode%2EclassName%2Esplit%28%2F%5Cs%2B%2F%29%29%3Bfor%28var%20q%3D0%3Bq%3Cr%2Elength%3Bq%2B%2B%29%7Bvar%20p%3Dr%5Bq%5D%2Ereplace%28%2F%5Elanguage%2D%2F%2C%22%22%29%3Bif%28e%5Bp%5D%29%7Breturn%20p%7D%7D%7Dfunction%20c%28q%29%7Bvar%20p%3D%5B%5D%3B%28function%28s%2Ct%29%7Bfor%28var%20r%3D0%3Br%3Cs%2EchildNodes%2Elength%3Br%2B%2B%29%7Bif%28s%2EchildNodes%5Br%5D%2EnodeType%3D%3D3%29%7Bt%2B%3Ds%2EchildNodes%5Br%5D%2EnodeValue%2Elength%7Delse%7Bif%28s%2EchildNodes%5Br%5D%2EnodeName%3D%3D%22BR%22%29%7Bt%2B%3D1%7Delse%7Bif%28s%2EchildNodes%5Br%5D%2EnodeType%3D%3D1%29%7Bp%2Epush%28%7Bevent%3A%22start%22%2Coffset%3At%2Cnode%3As%2EchildNodes%5Br%5D%7D%29%3Bt%3Darguments%2Ecallee%28s%2EchildNodes%5Br%5D%2Ct%29%3Bp%2Epush%28%7Bevent%3A%22stop%22%2Coffset%3At%2Cnode%3As%2EchildNodes%5Br%5D%7D%29%7D%7D%7D%7Dreturn%20t%7D%29%28q%2C0%29%3Breturn%20p%7Dfunction%20k%28y%2Cw%2Cx%29%7Bvar%20q%3D0%3Bvar%20z%3D%22%22%3Bvar%20s%3D%5B%5D%3Bfunction%20u%28%29%7Bif%28y%2Elength%26%26w%2Elength%29%7Bif%28y%5B0%5D%2Eoffset%21%3Dw%5B0%5D%2Eoffset%29%7Breturn%28y%5B0%5D%2Eoffset%3Cw%5B0%5D%2Eoffset%29%3Fy%3Aw%7Delse%7Breturn%20w%5B0%5D%2Eevent%3D%3D%22start%22%3Fy%3Aw%7D%7Delse%7Breturn%20y%2Elength%3Fy%3Aw%7D%7Dfunction%20t%28D%29%7Bvar%20A%3D%22%3C%22%2BD%2EnodeName%2EtoLowerCase%28%29%3Bfor%28var%20B%3D0%3BB%3CD%2Eattributes%2Elength%3BB%2B%2B%29%7Bvar%20C%3DD%2Eattributes%5BB%5D%3BA%2B%3D%22%20%22%2BC%2EnodeName%2EtoLowerCase%28%29%3Bif%28C%2Evalue%21%3D%3Dundefined%26%26C%2Evalue%21%3D%3Dfalse%26%26C%2Evalue%21%3D%3Dnull%29%7BA%2B%3D%27%3D%22%27%2Bm%28C%2Evalue%29%2B%27%22%27%7D%7Dreturn%20A%2B%22%3E%22%7Dwhile%28y%2Elength%7C%7Cw%2Elength%29%7Bvar%20v%3Du%28%29%2Esplice%280%2C1%29%5B0%5D%3Bz%2B%3Dm%28x%2Esubstr%28q%2Cv%2Eoffset%2Dq%29%29%3Bq%3Dv%2Eoffset%3Bif%28v%2Eevent%3D%3D%22start%22%29%7Bz%2B%3Dt%28v%2Enode%29%3Bs%2Epush%28v%2Enode%29%7Delse%7Bif%28v%2Eevent%3D%3D%22stop%22%29%7Bvar%20p%2Cr%3Ds%2Elength%3Bdo%7Br%2D%2D%3Bp%3Ds%5Br%5D%3Bz%2B%3D%28%22%3C%2F%22%2Bp%2EnodeName%2EtoLowerCase%28%29%2B%22%3E%22%29%7Dwhile%28p%21%3Dv%2Enode%29%3Bs%2Esplice%28r%2C1%29%3Bwhile%28r%3Cs%2Elength%29%7Bz%2B%3Dt%28s%5Br%5D%29%3Br%2B%2B%7D%7D%7D%7Dreturn%20z%2Bm%28x%2Esubstr%28q%29%29%7Dfunction%20j%28%29%7Bfunction%20q%28x%2Cy%2Cv%29%7Bif%28x%2Ecompiled%29%7Breturn%7Dvar%20u%3Bvar%20s%3D%5B%5D%3Bif%28x%2Ek%29%7Bx%2ElR%3Df%28y%2Cx%2El%7C%7Chljs%2EIR%2Ctrue%29%3Bfor%28var%20w%20in%20x%2Ek%29%7Bif%28%21x%2Ek%2EhasOwnProperty%28w%29%29%7Bcontinue%7Dif%28x%2Ek%5Bw%5D%20instanceof%20Object%29%7Bu%3Dx%2Ek%5Bw%5D%7Delse%7Bu%3Dx%2Ek%3Bw%3D%22keyword%22%7Dfor%28var%20r%20in%20u%29%7Bif%28%21u%2EhasOwnProperty%28r%29%29%7Bcontinue%7Dx%2Ek%5Br%5D%3D%5Bw%2Cu%5Br%5D%5D%3Bs%2Epush%28r%29%7D%7D%7Dif%28%21v%29%7Bif%28x%2EbWK%29%7Bx%2Eb%3D%22%5C%5Cb%28%22%2Bs%2Ejoin%28%22%7C%22%29%2B%22%29%5C%5Cs%22%7Dx%2EbR%3Df%28y%2Cx%2Eb%3Fx%2Eb%3A%22%5C%5CB%7C%5C%5Cb%22%29%3Bif%28%21x%2Ee%26%26%21x%2EeW%29%7Bx%2Ee%3D%22%5C%5CB%7C%5C%5Cb%22%7Dif%28x%2Ee%29%7Bx%2EeR%3Df%28y%2Cx%2Ee%29%7D%7Dif%28x%2Ei%29%7Bx%2EiR%3Df%28y%2Cx%2Ei%29%7Dif%28x%2Er%3D%3D%3Dundefined%29%7Bx%2Er%3D1%7Dif%28%21x%2Ec%29%7Bx%2Ec%3D%5B%5D%7Dx%2Ecompiled%3Dtrue%3Bfor%28var%20t%3D0%3Bt%3Cx%2Ec%2Elength%3Bt%2B%2B%29%7Bif%28x%2Ec%5Bt%5D%3D%3D%22self%22%29%7Bx%2Ec%5Bt%5D%3Dx%7Dq%28x%2Ec%5Bt%5D%2Cy%2Cfalse%29%7Dif%28x%2Estarts%29%7Bq%28x%2Estarts%2Cy%2Cfalse%29%7D%7Dfor%28var%20p%20in%20e%29%7Bif%28%21e%2EhasOwnProperty%28p%29%29%7Bcontinue%7Dq%28e%5Bp%5D%2EdM%2Ce%5Bp%5D%2Ctrue%29%7D%7Dfunction%20d%28B%2CC%29%7Bif%28%21j%2Ecalled%29%7Bj%28%29%3Bj%2Ecalled%3Dtrue%7Dfunction%20q%28r%2CM%29%7Bfor%28var%20L%3D0%3BL%3CM%2Ec%2Elength%3BL%2B%2B%29%7Bif%28%28M%2Ec%5BL%5D%2EbR%2Eexec%28r%29%7C%7C%5Bnull%5D%29%5B0%5D%3D%3Dr%29%7Breturn%20M%2Ec%5BL%5D%7D%7D%7Dfunction%20v%28L%2Cr%29%7Bif%28D%5BL%5D%2Ee%26%26D%5BL%5D%2EeR%2Etest%28r%29%29%7Breturn%201%7Dif%28D%5BL%5D%2EeW%29%7Bvar%20M%3Dv%28L%2D1%2Cr%29%3Breturn%20M%3FM%2B1%3A0%7Dreturn%200%7Dfunction%20w%28r%2CL%29%7Breturn%20L%2Ei%26%26L%2EiR%2Etest%28r%29%7Dfunction%20K%28N%2CO%29%7Bvar%20M%3D%5B%5D%3Bfor%28var%20L%3D0%3BL%3CN%2Ec%2Elength%3BL%2B%2B%29%7BM%2Epush%28N%2Ec%5BL%5D%2Eb%29%7Dvar%20r%3DD%2Elength%2D1%3Bdo%7Bif%28D%5Br%5D%2Ee%29%7BM%2Epush%28D%5Br%5D%2Ee%29%7Dr%2D%2D%7Dwhile%28D%5Br%2B1%5D%2EeW%29%3Bif%28N%2Ei%29%7BM%2Epush%28N%2Ei%29%7Dreturn%20f%28O%2CM%2Ejoin%28%22%7C%22%29%2Ctrue%29%7Dfunction%20p%28M%2CL%29%7Bvar%20N%3DD%5BD%2Elength%2D1%5D%3Bif%28%21N%2Et%29%7BN%2Et%3DK%28N%2CE%29%7DN%2Et%2ElastIndex%3DL%3Bvar%20r%3DN%2Et%2Eexec%28M%29%3Breturn%20r%3F%5BM%2Esubstr%28L%2Cr%2Eindex%2DL%29%2Cr%5B0%5D%2Cfalse%5D%3A%5BM%2Esubstr%28L%29%2C%22%22%2Ctrue%5D%7Dfunction%20z%28N%2Cr%29%7Bvar%20L%3DE%2EcI%3Fr%5B0%5D%2EtoLowerCase%28%29%3Ar%5B0%5D%3Bvar%20M%3DN%2Ek%5BL%5D%3Bif%28M%26%26M%20instanceof%20Array%29%7Breturn%20M%7Dreturn%20false%7Dfunction%20F%28L%2CP%29%7BL%3Dm%28L%29%3Bif%28%21P%2Ek%29%7Breturn%20L%7Dvar%20r%3D%22%22%3Bvar%20O%3D0%3BP%2ElR%2ElastIndex%3D0%3Bvar%20M%3DP%2ElR%2Eexec%28L%29%3Bwhile%28M%29%7Br%2B%3DL%2Esubstr%28O%2CM%2Eindex%2DO%29%3Bvar%20N%3Dz%28P%2CM%29%3Bif%28N%29%7Bx%2B%3DN%5B1%5D%3Br%2B%3D%27%3Cspan%20class%3D%22%27%2BN%5B0%5D%2B%27%22%3E%27%2BM%5B0%5D%2B%22%3C%2Fspan%3E%22%7Delse%7Br%2B%3DM%5B0%5D%7DO%3DP%2ElR%2ElastIndex%3BM%3DP%2ElR%2Eexec%28L%29%7Dreturn%20r%2BL%2Esubstr%28O%2CL%2Elength%2DO%29%7Dfunction%20J%28L%2CM%29%7Bif%28M%2EsL%26%26e%5BM%2EsL%5D%29%7Bvar%20r%3Dd%28M%2EsL%2CL%29%3Bx%2B%3Dr%2Ekeyword%5Fcount%3Breturn%20r%2Evalue%7Delse%7Breturn%20F%28L%2CM%29%7D%7Dfunction%20I%28M%2Cr%29%7Bvar%20L%3DM%2EcN%3F%27%3Cspan%20class%3D%22%27%2BM%2EcN%2B%27%22%3E%27%3A%22%22%3Bif%28M%2ErB%29%7By%2B%3DL%3BM%2Ebuffer%3D%22%22%7Delse%7Bif%28M%2EeB%29%7By%2B%3Dm%28r%29%2BL%3BM%2Ebuffer%3D%22%22%7Delse%7By%2B%3DL%3BM%2Ebuffer%3Dr%7D%7DD%2Epush%28M%29%3BA%2B%3DM%2Er%7Dfunction%20G%28N%2CM%2CQ%29%7Bvar%20R%3DD%5BD%2Elength%2D1%5D%3Bif%28Q%29%7By%2B%3DJ%28R%2Ebuffer%2BN%2CR%29%3Breturn%20false%7Dvar%20P%3Dq%28M%2CR%29%3Bif%28P%29%7By%2B%3DJ%28R%2Ebuffer%2BN%2CR%29%3BI%28P%2CM%29%3Breturn%20P%2ErB%7Dvar%20L%3Dv%28D%2Elength%2D1%2CM%29%3Bif%28L%29%7Bvar%20O%3DR%2EcN%3F%22%3C%2Fspan%3E%22%3A%22%22%3Bif%28R%2ErE%29%7By%2B%3DJ%28R%2Ebuffer%2BN%2CR%29%2BO%7Delse%7Bif%28R%2EeE%29%7By%2B%3DJ%28R%2Ebuffer%2BN%2CR%29%2BO%2Bm%28M%29%7Delse%7By%2B%3DJ%28R%2Ebuffer%2BN%2BM%2CR%29%2BO%7D%7Dwhile%28L%3E1%29%7BO%3DD%5BD%2Elength%2D2%5D%2EcN%3F%22%3C%2Fspan%3E%22%3A%22%22%3By%2B%3DO%3BL%2D%2D%3BD%2Elength%2D%2D%7Dvar%20r%3DD%5BD%2Elength%2D1%5D%3BD%2Elength%2D%2D%3BD%5BD%2Elength%2D1%5D%2Ebuffer%3D%22%22%3Bif%28r%2Estarts%29%7BI%28r%2Estarts%2C%22%22%29%7Dreturn%20R%2ErE%7Dif%28w%28M%2CR%29%29%7Bthrow%22Illegal%22%7D%7Dvar%20E%3De%5BB%5D%3Bvar%20D%3D%5BE%2EdM%5D%3Bvar%20A%3D0%3Bvar%20x%3D0%3Bvar%20y%3D%22%22%3Btry%7Bvar%20s%2Cu%3D0%3BE%2EdM%2Ebuffer%3D%22%22%3Bdo%7Bs%3Dp%28C%2Cu%29%3Bvar%20t%3DG%28s%5B0%5D%2Cs%5B1%5D%2Cs%5B2%5D%29%3Bu%2B%3Ds%5B0%5D%2Elength%3Bif%28%21t%29%7Bu%2B%3Ds%5B1%5D%2Elength%7D%7Dwhile%28%21s%5B2%5D%29%3Bif%28D%2Elength%3E1%29%7Bthrow%22Illegal%22%7Dreturn%7Br%3AA%2Ckeyword%5Fcount%3Ax%2Cvalue%3Ay%7D%7Dcatch%28H%29%7Bif%28H%3D%3D%22Illegal%22%29%7Breturn%7Br%3A0%2Ckeyword%5Fcount%3A0%2Cvalue%3Am%28C%29%7D%7Delse%7Bthrow%20H%7D%7D%7Dfunction%20g%28t%29%7Bvar%20p%3D%7Bkeyword%5Fcount%3A0%2Cr%3A0%2Cvalue%3Am%28t%29%7D%3Bvar%20r%3Dp%3Bfor%28var%20q%20in%20e%29%7Bif%28%21e%2EhasOwnProperty%28q%29%29%7Bcontinue%7Dvar%20s%3Dd%28q%2Ct%29%3Bs%2Elanguage%3Dq%3Bif%28s%2Ekeyword%5Fcount%2Bs%2Er%3Er%2Ekeyword%5Fcount%2Br%2Er%29%7Br%3Ds%7Dif%28s%2Ekeyword%5Fcount%2Bs%2Er%3Ep%2Ekeyword%5Fcount%2Bp%2Er%29%7Br%3Dp%3Bp%3Ds%7D%7Dif%28r%2Elanguage%29%7Bp%2Esecond%5Fbest%3Dr%7Dreturn%20p%7Dfunction%20i%28r%2Cq%2Cp%29%7Bif%28q%29%7Br%3Dr%2Ereplace%28%2F%5E%28%28%3C%5B%5E%3E%5D%2B%3E%7C%5Ct%29%2B%29%2Fgm%2Cfunction%28t%2Cw%2Cv%2Cu%29%7Breturn%20w%2Ereplace%28%2F%5Ct%2Fg%2Cq%29%7D%29%7Dif%28p%29%7Br%3Dr%2Ereplace%28%2F%5Cn%2Fg%2C%22%3Cbr%3E%22%29%7Dreturn%20r%7Dfunction%20n%28t%2Cw%2Cr%29%7Bvar%20x%3Dh%28t%2Cr%29%3Bvar%20v%3Da%28t%29%3Bvar%20y%2Cs%3Bif%28v%29%7By%3Dd%28v%2Cx%29%7Delse%7Breturn%7Dvar%20q%3Dc%28t%29%3Bif%28q%2Elength%29%7Bs%3Ddocument%2EcreateElement%28%22pre%22%29%3Bs%2EinnerHTML%3Dy%2Evalue%3By%2Evalue%3Dk%28q%2Cc%28s%29%2Cx%29%7Dy%2Evalue%3Di%28y%2Evalue%2Cw%2Cr%29%3Bvar%20u%3Dt%2EclassName%3Bif%28%21u%2Ematch%28%22%28%5C%5Cs%7C%5E%29%28language%2D%29%3F%22%2Bv%2B%22%28%5C%5Cs%7C%24%29%22%29%29%7Bu%3Du%3F%28u%2B%22%20%22%2Bv%29%3Av%7Dif%28%2FMSIE%20%5B678%5D%2F%2Etest%28navigator%2EuserAgent%29%26%26t%2EtagName%3D%3D%22CODE%22%26%26t%2EparentNode%2EtagName%3D%3D%22PRE%22%29%7Bs%3Dt%2EparentNode%3Bvar%20p%3Ddocument%2EcreateElement%28%22div%22%29%3Bp%2EinnerHTML%3D%22%3Cpre%3E%3Ccode%3E%22%2By%2Evalue%2B%22%3C%2Fcode%3E%3C%2Fpre%3E%22%3Bt%3Dp%2EfirstChild%2EfirstChild%3Bp%2EfirstChild%2EcN%3Ds%2EcN%3Bs%2EparentNode%2EreplaceChild%28p%2EfirstChild%2Cs%29%7Delse%7Bt%2EinnerHTML%3Dy%2Evalue%7Dt%2EclassName%3Du%3Bt%2Eresult%3D%7Blanguage%3Av%2Ckw%3Ay%2Ekeyword%5Fcount%2Cre%3Ay%2Er%7D%3Bif%28y%2Esecond%5Fbest%29%7Bt%2Esecond%5Fbest%3D%7Blanguage%3Ay%2Esecond%5Fbest%2Elanguage%2Ckw%3Ay%2Esecond%5Fbest%2Ekeyword%5Fcount%2Cre%3Ay%2Esecond%5Fbest%2Er%7D%7D%7Dfunction%20o%28%29%7Bif%28o%2Ecalled%29%7Breturn%7Do%2Ecalled%3Dtrue%3Bvar%20r%3Ddocument%2EgetElementsByTagName%28%22pre%22%29%3Bfor%28var%20p%3D0%3Bp%3Cr%2Elength%3Bp%2B%2B%29%7Bvar%20q%3Db%28r%5Bp%5D%29%3Bif%28q%29%7Bn%28q%2Chljs%2EtabReplace%29%7D%7D%7Dfunction%20l%28%29%7Bif%28window%2EaddEventListener%29%7Bwindow%2EaddEventListener%28%22DOMContentLoaded%22%2Co%2Cfalse%29%3Bwindow%2EaddEventListener%28%22load%22%2Co%2Cfalse%29%7Delse%7Bif%28window%2EattachEvent%29%7Bwindow%2EattachEvent%28%22onload%22%2Co%29%7Delse%7Bwindow%2Eonload%3Do%7D%7D%7Dvar%20e%3D%7B%7D%3Bthis%2ELANGUAGES%3De%3Bthis%2Ehighlight%3Dd%3Bthis%2EhighlightAuto%3Dg%3Bthis%2EfixMarkup%3Di%3Bthis%2EhighlightBlock%3Dn%3Bthis%2EinitHighlighting%3Do%3Bthis%2EinitHighlightingOnLoad%3Dl%3Bthis%2EIR%3D%22%5Ba%2DzA%2DZ%5D%5Ba%2DzA%2DZ0%2D9%5F%5D%2A%22%3Bthis%2EUIR%3D%22%5Ba%2DzA%2DZ%5F%5D%5Ba%2DzA%2DZ0%2D9%5F%5D%2A%22%3Bthis%2ENR%3D%22%5C%5Cb%5C%5Cd%2B%28%5C%5C%2E%5C%5Cd%2B%29%3F%22%3Bthis%2ECNR%3D%22%5C%5Cb%280%5BxX%5D%5Ba%2DfA%2DF0%2D9%5D%2B%7C%28%5C%5Cd%2B%28%5C%5C%2E%5C%5Cd%2A%29%3F%7C%5C%5C%2E%5C%5Cd%2B%29%28%5BeE%5D%5B%2D%2B%5D%3F%5C%5Cd%2B%29%3F%29%22%3Bthis%2EBNR%3D%22%5C%5Cb%280b%5B01%5D%2B%29%22%3Bthis%2ERSR%3D%22%21%7C%21%3D%7C%21%3D%3D%7C%25%7C%25%3D%7C%26%7C%26%26%7C%26%3D%7C%5C%5C%2A%7C%5C%5C%2A%3D%7C%5C%5C%2B%7C%5C%5C%2B%3D%7C%2C%7C%5C%5C%2E%7C%2D%7C%2D%3D%7C%2F%7C%2F%3D%7C%3A%7C%3B%7C%3C%7C%3C%3C%7C%3C%3C%3D%7C%3C%3D%7C%3D%7C%3D%3D%7C%3D%3D%3D%7C%3E%7C%3E%3D%7C%3E%3E%7C%3E%3E%3D%7C%3E%3E%3E%7C%3E%3E%3E%3D%7C%5C%5C%3F%7C%5C%5C%5B%7C%5C%5C%7B%7C%5C%5C%28%7C%5C%5C%5E%7C%5C%5C%5E%3D%7C%5C%5C%7C%7C%5C%5C%7C%3D%7C%5C%5C%7C%5C%5C%7C%7C%7E%22%3Bthis%2EER%3D%22%28%3F%21%5B%5C%5Cs%5C%5CS%5D%29%22%3Bthis%2EBE%3D%7Bb%3A%22%5C%5C%5C%5C%2E%22%2Cr%3A0%7D%3Bthis%2EASM%3D%7BcN%3A%22string%22%2Cb%3A%22%27%22%2Ce%3A%22%27%22%2Ci%3A%22%5C%5Cn%22%2Cc%3A%5Bthis%2EBE%5D%2Cr%3A0%7D%3Bthis%2EQSM%3D%7BcN%3A%22string%22%2Cb%3A%27%22%27%2Ce%3A%27%22%27%2Ci%3A%22%5C%5Cn%22%2Cc%3A%5Bthis%2EBE%5D%2Cr%3A0%7D%3Bthis%2ECLCM%3D%7BcN%3A%22comment%22%2Cb%3A%22%2F%2F%22%2Ce%3A%22%24%22%7D%3Bthis%2ECBLCLM%3D%7BcN%3A%22comment%22%2Cb%3A%22%2F%5C%5C%2A%22%2Ce%3A%22%5C%5C%2A%2F%22%7D%3Bthis%2EHCM%3D%7BcN%3A%22comment%22%2Cb%3A%22%23%22%2Ce%3A%22%24%22%7D%3Bthis%2ENM%3D%7BcN%3A%22number%22%2Cb%3Athis%2ENR%2Cr%3A0%7D%3Bthis%2ECNM%3D%7BcN%3A%22number%22%2Cb%3Athis%2ECNR%2Cr%3A0%7D%3Bthis%2EBNM%3D%7BcN%3A%22number%22%2Cb%3Athis%2EBNR%2Cr%3A0%7D%3Bthis%2Einherit%3Dfunction%28r%2Cs%29%7Bvar%20p%3D%7B%7D%3Bfor%28var%20q%20in%20r%29%7Bp%5Bq%5D%3Dr%5Bq%5D%7Dif%28s%29%7Bfor%28var%20q%20in%20s%29%7Bp%5Bq%5D%3Ds%5Bq%5D%7D%7Dreturn%20p%7D%7D%28%29%3Bhljs%2ELANGUAGES%2Ecpp%3Dfunction%28%29%7Bvar%20a%3D%7Bkeyword%3A%7B%22false%22%3A1%2C%22int%22%3A1%2C%22float%22%3A1%2C%22while%22%3A1%2C%22private%22%3A1%2C%22char%22%3A1%2C%22catch%22%3A1%2C%22export%22%3A1%2Cvirtual%3A1%2Coperator%3A2%2Csizeof%3A2%2Cdynamic%5Fcast%3A2%2Ctypedef%3A2%2Cconst%5Fcast%3A2%2C%22const%22%3A1%2Cstruct%3A1%2C%22for%22%3A1%2Cstatic%5Fcast%3A2%2Cunion%3A1%2Cnamespace%3A1%2Cunsigned%3A1%2C%22long%22%3A1%2C%22throw%22%3A1%2C%22volatile%22%3A2%2C%22static%22%3A1%2C%22protected%22%3A1%2Cbool%3A1%2Ctemplate%3A1%2Cmutable%3A1%2C%22if%22%3A1%2C%22public%22%3A1%2Cfriend%3A2%2C%22do%22%3A1%2C%22return%22%3A1%2C%22goto%22%3A1%2Cauto%3A1%2C%22void%22%3A2%2C%22enum%22%3A1%2C%22else%22%3A1%2C%22break%22%3A1%2C%22new%22%3A1%2Cextern%3A1%2Cusing%3A1%2C%22true%22%3A1%2C%22class%22%3A1%2Casm%3A1%2C%22case%22%3A1%2Ctypeid%3A1%2C%22short%22%3A1%2Creinterpret%5Fcast%3A2%2C%22default%22%3A1%2C%22double%22%3A1%2Cregister%3A1%2Cexplicit%3A1%2Csigned%3A1%2Ctypename%3A1%2C%22try%22%3A1%2C%22this%22%3A1%2C%22switch%22%3A1%2C%22continue%22%3A1%2Cwchar%5Ft%3A1%2Cinline%3A1%2C%22delete%22%3A1%2Calignof%3A1%2Cchar16%5Ft%3A1%2Cchar32%5Ft%3A1%2Cconstexpr%3A1%2Cdecltype%3A1%2Cnoexcept%3A1%2Cnullptr%3A1%2Cstatic%5Fassert%3A1%2Cthread%5Flocal%3A1%2Crestrict%3A1%2C%5FBool%3A1%2Ccomplex%3A1%7D%2Cbuilt%5Fin%3A%7Bstd%3A1%2Cstring%3A1%2Ccin%3A1%2Ccout%3A1%2Ccerr%3A1%2Cclog%3A1%2Cstringstream%3A1%2Cistringstream%3A1%2Costringstream%3A1%2Cauto%5Fptr%3A1%2Cdeque%3A1%2Clist%3A1%2Cqueue%3A1%2Cstack%3A1%2Cvector%3A1%2Cmap%3A1%2Cset%3A1%2Cbitset%3A1%2Cmultiset%3A1%2Cmultimap%3A1%2Cunordered%5Fset%3A1%2Cunordered%5Fmap%3A1%2Cunordered%5Fmultiset%3A1%2Cunordered%5Fmultimap%3A1%2Carray%3A1%2Cshared%5Fptr%3A1%7D%7D%3Breturn%7BdM%3A%7Bk%3Aa%2Ci%3A%22%3C%2F%22%2Cc%3A%5Bhljs%2ECLCM%2Chljs%2ECBLCLM%2Chljs%2EQSM%2C%7BcN%3A%22string%22%2Cb%3A%22%27%5C%5C%5C%5C%3F%2E%22%2Ce%3A%22%27%22%2Ci%3A%22%2E%22%7D%2C%7BcN%3A%22number%22%2Cb%3A%22%5C%5Cb%28%5C%5Cd%2B%28%5C%5C%2E%5C%5Cd%2A%29%3F%7C%5C%5C%2E%5C%5Cd%2B%29%28u%7CU%7Cl%7CL%7Cul%7CUL%7Cf%7CF%29%22%7D%2Chljs%2ECNM%2C%7BcN%3A%22preprocessor%22%2Cb%3A%22%23%22%2Ce%3A%22%24%22%7D%2C%7BcN%3A%22stl%5Fcontainer%22%2Cb%3A%22%5C%5Cb%28deque%7Clist%7Cqueue%7Cstack%7Cvector%7Cmap%7Cset%7Cbitset%7Cmultiset%7Cmultimap%7Cunordered%5Fmap%7Cunordered%5Fset%7Cunordered%5Fmultiset%7Cunordered%5Fmultimap%7Carray%29%5C%5Cs%2A%3C%22%2Ce%3A%22%3E%22%2Ck%3Aa%2Cr%3A10%2Cc%3A%5B%22self%22%5D%7D%5D%7D%7D%7D%28%29%3Bhljs%2ELANGUAGES%2Er%3D%7BdM%3A%7Bc%3A%5Bhljs%2EHCM%2C%7BcN%3A%22number%22%2Cb%3A%22%5C%5Cb0%5BxX%5D%5B0%2D9a%2DfA%2DF%5D%2B%5BLi%5D%3F%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A0%7D%2C%7BcN%3A%22number%22%2Cb%3A%22%5C%5Cb%5C%5Cd%2B%28%3F%3A%5BeE%5D%5B%2B%5C%5C%2D%5D%3F%5C%5Cd%2A%29%3FL%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A0%7D%2C%7BcN%3A%22number%22%2Cb%3A%22%5C%5Cb%5C%5Cd%2B%5C%5C%2E%28%3F%21%5C%5Cd%29%28%3F%3Ai%5C%5Cb%29%3F%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A1%7D%2C%7BcN%3A%22number%22%2Cb%3A%22%5C%5Cb%5C%5Cd%2B%28%3F%3A%5C%5C%2E%5C%5Cd%2A%29%3F%28%3F%3A%5BeE%5D%5B%2B%5C%5C%2D%5D%3F%5C%5Cd%2A%29%3Fi%3F%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A0%7D%2C%7BcN%3A%22number%22%2Cb%3A%22%5C%5C%2E%5C%5Cd%2B%28%3F%3A%5BeE%5D%5B%2B%5C%5C%2D%5D%3F%5C%5Cd%2A%29%3Fi%3F%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A1%7D%2C%7BcN%3A%22keyword%22%2Cb%3A%22%28%3F%3AtryCatch%7Clibrary%7CsetGeneric%7CsetGroupGeneric%29%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A10%7D%2C%7BcN%3A%22keyword%22%2Cb%3A%22%5C%5C%2E%5C%5C%2E%5C%5C%2E%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A10%7D%2C%7BcN%3A%22keyword%22%2Cb%3A%22%5C%5C%2E%5C%5C%2E%5C%5Cd%2B%28%3F%21%5B%5C%5Cw%2E%5D%29%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A10%7D%2C%7BcN%3A%22keyword%22%2Cb%3A%22%5C%5Cb%28%3F%3Afunction%29%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A2%7D%2C%7BcN%3A%22keyword%22%2Cb%3A%22%28%3F%3Aif%7Cin%7Cbreak%7Cnext%7Crepeat%7Celse%7Cfor%7Creturn%7Cswitch%7Cwhile%7Ctry%7Cstop%7Cwarning%7Crequire%7Cattach%7Cdetach%7Csource%7CsetMethod%7CsetClass%29%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A1%7D%2C%7BcN%3A%22literal%22%2Cb%3A%22%28%3F%3ANA%7CNA%5Finteger%5F%7CNA%5Freal%5F%7CNA%5Fcharacter%5F%7CNA%5Fcomplex%5F%29%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A10%7D%2C%7BcN%3A%22literal%22%2Cb%3A%22%28%3F%3ANULL%7CTRUE%7CFALSE%7CT%7CF%7CInf%7CNaN%29%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A1%7D%2C%7BcN%3A%22identifier%22%2Cb%3A%22%5Ba%2DzA%2DZ%2E%5D%5Ba%2DzA%2DZ0%2D9%2E%5F%5D%2A%5C%5Cb%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A0%7D%2C%7BcN%3A%22operator%22%2Cb%3A%22%3C%5C%5C%2D%28%3F%21%5C%5Cs%2A%5C%5Cd%29%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A2%7D%2C%7BcN%3A%22operator%22%2Cb%3A%22%5C%5C%2D%3E%7C%3C%5C%5C%2D%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A1%7D%2C%7BcN%3A%22operator%22%2Cb%3A%22%25%25%7C%7E%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%7D%2C%7BcN%3A%22operator%22%2Cb%3A%22%3E%3D%7C%3C%3D%7C%3D%3D%7C%21%3D%7C%5C%5C%7C%5C%5C%7C%7C%26%26%7C%3D%7C%5C%5C%2B%7C%5C%5C%2D%7C%5C%5C%2A%7C%2F%7C%5C%5C%5E%7C%3E%7C%3C%7C%21%7C%26%7C%5C%5C%7C%7C%5C%5C%24%7C%3A%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A0%7D%2C%7BcN%3A%22operator%22%2Cb%3A%22%25%22%2Ce%3A%22%25%22%2Ci%3A%22%5C%5Cn%22%2Cr%3A1%7D%2C%7BcN%3A%22identifier%22%2Cb%3A%22%60%22%2Ce%3A%22%60%22%2Cr%3A0%7D%2C%7BcN%3A%22string%22%2Cb%3A%27%22%27%2Ce%3A%27%22%27%2Cc%3A%5Bhljs%2EBE%5D%2Cr%3A0%7D%2C%7BcN%3A%22string%22%2Cb%3A%22%27%22%2Ce%3A%22%27%22%2Cc%3A%5Bhljs%2EBE%5D%2Cr%3A0%7D%2C%7BcN%3A%22paren%22%2Cb%3A%22%5B%5B%28%7B%5C%5C%5D%29%7D%5D%22%2Ce%3Ahljs%2EIMMEDIATE%5FRE%2Cr%3A0%7D%5D%7D%7D%3B%0Ahljs%2EinitHighlightingOnLoad%28%29%3B%0A%0A"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%200%20auto%3B%0A%20%20max%2Dwidth%3A%20800px%3B%0A%20%20float%3A%20center%3B%0A%20%20margin%2Dleft%3A%20auto%3B%0A%20%20margin%2Dright%3A%20auto%3B%0A%20%20overflow%3A%20visible%3B%0A%7D%0A%20%20body%20%23header%20%7B%0A%20%20%20%20clear%3A%20both%3B%0A%20%20%20%20margin%2Dbottom%3A%208px%3B%0A%20%20%20%20border%2Dbottom%3A%202px%20solid%20%23999%3B%0A%20%20%20%20font%2Dsize%3A%2020px%3B%0A%20%20%20%20padding%3A%202px%2010px%202px%2025px%3B%0A%20%20%7D%0A%20%20body%20%23content%20%7B%0A%20%20%20%20background%2Dcolor%3A%20white%3B%0A%20%20%20%20clear%3A%20both%3B%0A%20%20%20%20float%3A%20left%3B%0A%20%20%20%20overflow%3A%20visible%3B%0A%20%20%20%20padding%3A%2010px%3B%0A%20%20%20%20border%3A%201px%20solid%20%23BBBBBB%3B%0A%20%20%20%20border%2Dradius%3A%205px%3B%0A%20%20%20%20width%3A%20780px%3B%0A%20%20%7D%0A%20%20body%20%23footer%20%7B%0A%20%20%20%20background%2Dcolor%3A%20%2399BBDD%3B%0A%20%20%20%20clear%3A%20both%3B%0A%20%20%20%20float%3A%20left%3B%0A%20%20%20%20margin%3A%208px%200%3B%0A%20%20%20%20border%3A%201px%20solid%20%236688AA%3B%0A%20%20%20%20border%2Dradius%3A%205px%3B%0A%20%20%20%20padding%3A%200%2010px%3B%0A%20%20%20%20width%3A%20780px%3B%0A%20%20%7D%0Abody%20%2Eclear%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20border%2Dwidth%3A%200%3B%0A%20%20margin%3A%200%3B%0A%20%20visibility%3A%20hidden%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%2016px%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%2Dleft%3A%2025px%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dspacing%3A%200px%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcolor%3A%20gray%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20background%2Dcolor%3A%20white%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20background%2Dcolor%3A%20white%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%202px%205px%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%2Dleft%3A%2015px%3B%0A%20%20margin%2Dbottom%3A%205px%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%2013px%3B%0A%20%20padding%2Dbottom%3A%201px%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20color%3A%20%23000%3B%0A%20%20padding%3A%200px%3B%0A%7D%0A%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20color%3A%20%23333%3B%0A%20%20border%3A%201px%20solid%20%23ddd%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20background%2Dcolor%3A%20%23f8f8f8%3B%0A%20%20font%2Dsize%3A%2080%25%3B%0A%20%20padding%3A%200px%202px%3B%0A%7D%0A%0A%2F%2Apre%20%3E%20code%20%7B%0A%20%20font%2Dsize%3A%2012px%3B%0A%20%20line%2Dheight%3A%2016px%3B%0A%7D%2A%2F%0A%0Apre%20%7B%0A%20%20font%2Dsize%3A%2012px%3B%0A%20%20line%2Dheight%3A%2016px%3B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%7D%0A%0Apre%2Er%20%7B%0A%20%20background%2Dcolor%3A%20%23F3F5F7%3B%0A%20%20padding%3A%204px%2010px%3B%0A%20%20border%3A%201px%20solid%20%23AEBDCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%20%20margin%3A%205px%205px%2010px%2020px%3B%0A%7D%0A%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20box%2Dshadow%3A%202px%202px%2012px%20%2D5px%20%23999999%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Abody%20%7B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2015px%3B%0A%20%20line%2Dheight%3A%2022px%3B%0A%7D%0A%20%20body%20%23header%20%7B%0A%20%20%7D%0A%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23ccc%3B%0A%20%20width%3A%2085%25%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%2022px%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23ccc%3B%0A%20%20width%3A%2075%25%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%2018px%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20width%3A%2060%25%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%2016px%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20width%3A%2060%25%3B%0A%20%20margin%2Dleft%3A%2015px%3B%0A%20%20font%2Dsize%3A%2016px%3B%0A%7D%0A%0Ah4%2Eauthor%20%7B%0A%20%20border%2Dbottom%3A%20none%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0Adl%20dt%20%7B%0A%20%20font%2Dweight%3A%20bold%3B%0A%7D%0A%0A%0Apre%20%2Eoperator%2C%0Apre%20%2Eparen%20%7B%0A%20%20color%3A%20%23888%3B%0A%7D%0A%0Apre%20%2Eliteral%20%7B%0A%20color%3A%20%23990073%3B%0A%7D%0A%0Apre%20%2Enumber%20%7B%0A%20color%3A%20%230080C0%3B%0A%7D%0A%0Apre%20%2Ecomment%20%7B%0A%20color%3A%20%23008000%3B%0A%20font%2Dstyle%3A%20italic%0A%7D%0A%0Apre%20%2Ekeyword%20%7B%0A%20color%3A%20%23900%3B%0A%20font%2Dweight%3A%20bold%0A%7D%0A%0Apre%20%2Eidentifier%20%7B%0A%20color%3A%20%23000%3B%0A%7D%0A%0Apre%20%2Estring%20%7B%0A%20color%3A%20%23b44%3B%0A%7D%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">R6 and Reference class performance tests</h1>
</div>

<div id="TOC">
<ul>
<li><a href="#class-definitions">Class definitions</a><ul>
<li><a href="#r-reference-class">R reference class</a></li>
<li><a href="#r6-class">R6 class</a></li>
<li><a href="#r6-class-without-class-attribute">R6 class, without class attribute</a></li>
<li><a href="#r6-class-non-portable">R6 class, non-portable</a></li>
<li><a href="#r6-class-without-class-attribute-and-non-portable">R6 class, without class attribute, and non-portable</a></li>
<li><a href="#r6-class-with-public-and-private-members">R6 class, with public and private members</a></li>
<li><a href="#r6-class-with-public-and-private-members-no-class-attribute-and-non-portable">R6 class, with public and private members, no class attribute, and non-portable</a></li>
<li><a href="#environment-created-by-a-closure-with-class-attribute">Environment created by a closure, with class attribute</a></li>
<li><a href="#environment-created-by-a-closure-without-class-attribute">Environment created by a closure, without class attribute</a></li>
</ul></li>
<li><a href="#tests">Tests</a><ul>
<li><a href="#memory-footprint">Memory footprint</a></li>
<li><a href="#object-instantiation-speed">Object instantiation speed</a></li>
<li><a href="#field-access-speed">Field access speed</a></li>
<li><a href="#field-setting-speed">Field setting speed</a></li>
<li><a href="#speed-of-method-call-that-accesses-a-field">Speed of method call that accesses a field</a></li>
<li><a href="#assignment-using-selfx---vs.-x--">Assignment using <code>self$x &lt;-</code> vs. <code>x &lt;&lt;-</code></a></li>
<li><a href="#overhead-from-using-on-objects-with-a-class-attribute">Overhead from using <code>$</code> on objects with a class attribute</a></li>
<li><a href="#lists-vs.environments-and-vs.">Lists vs. environments, and <code>$</code> vs. <code>[[</code></a></li>
</ul></li>
<li><a href="#wrap-up">Wrap-up</a></li>
<li><a href="#appendix">Appendix</a><ul>
<li><a href="#functions-for-calculating-object-sizes">Functions for calculating object sizes</a></li>
<li><a href="#system-information">System information</a></li>
</ul></li>
</ul>
</div>

<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Reference and R6 class performance tests}
-->



<p>This document compares the memory costs and speed of R’s reference classes against R6 classes and simple environments. For must uses, R6 and reference classes have comparable features, but as we’ll see, R6 classes are faster and lighter weight.</p>
<p>This document tests reference classes against R6 classes (in many variations), as well as against very simple reference objects: environments created by closures.</p>
<hr />
<p>First we’ll load some packages which will be used below:</p>
<pre class="r"><code>library(microbenchmark)
options(microbenchmark.unit = &quot;us&quot;)
library(pryr)  # For object_size function
library(R6)</code></pre>
<hr />
<div id="class-definitions" class="section level1">
<h1>Class definitions</h1>
<p>We’ll start by defining a number of classes or class-like entities, using reference classes, R6 classes, and simple environments that are created directly by functions. These classes will be used for the speed and memory tests that follow. This is a lot of boring code, so you may want to skip ahead to the results.</p>
<p>All of these classes have the same basic characteristics:</p>
<ul>
<li>A field named <code>x</code> that contains a number.</li>
<li>An way of initializing the value of <code>x</code>.</li>
<li>A method named <code>getx</code> for retrieving the value of <code>x</code>.</li>
<li>A method named <code>inc</code> for incrementing the value of <code>x</code>.</li>
</ul>
<p>The fields and methods are accessed with the <code>$</code> operator, so if we have an object named <code>obj</code>, we could use <code>obj$x</code> or <code>obj$getx()</code>.</p>
<div id="r-reference-class" class="section level2">
<h2>R reference class</h2>
<pre class="r"><code>RC &lt;- setRefClass(&quot;RC&quot;, 
  fields = list(x = &quot;numeric&quot;),
  methods = list(
    initialize = function(x = 1) .self$x &lt;- x,
    getx = function() x,
    inc = function(n = 1) x &lt;&lt;- x + n
  )
)</code></pre>
<p>In reference classes, the binding that points back to the object is named <code>.self</code>. Within a method, assignment can be done by using <code>.self</code>, as in <code>.self$x &lt;- 10</code>, or by using <code>&lt;&lt;-</code>, as in <code>x &lt;&lt;- 10</code>.</p>
<p>To create an object, simply call <code>$new()</code> on the class:</p>
<pre class="r"><code>RC$new()
#&gt; Reference class object of class &quot;RC&quot;
#&gt; Field &quot;x&quot;:
#&gt; [1] 1</code></pre>
</div>
<div id="r6-class" class="section level2">
<h2>R6 class</h2>
<p>Creating an R6 class is similar to the reference class, except that there’s no need to separate the fields and methods, and you can’t specify the types of the fields.</p>
<pre class="r"><code>R6 &lt;- R6Class(&quot;R6&quot;,
  public = list(
    x = NULL,
    initialize = function(x = 1) self$x &lt;- x,
    getx = function() self$x,
    inc = function(n = 1) self$x &lt;- x + n
  )
)</code></pre>
<p>Whereas reference classes use <code>.self</code>, R6 classes use <code>self</code> (without the leading period). As with reference classes, objects are instantiated by calling <code>$new()</code>:</p>
<pre class="r"><code>R6$new()
#&gt; &lt;R6&gt;
#&gt;   Public:
#&gt;     getx: function
#&gt;     inc: function
#&gt;     initialize: function
#&gt;     x: 1</code></pre>
<p>An R6 object essentially just an environment. The methods for an R6 object have bindings (that is, they have names) in that environment, and also have that environment as their enclosing environment (they “run in” that environment).</p>
</div>
<div id="r6-class-without-class-attribute" class="section level2">
<h2>R6 class, without class attribute</h2>
<p>By default, a class attribute is added to R6 objects. This attribute adds a slight performance penalty because R will attempt to use S3 dispatch when using <code>$</code> on the object.</p>
<p>It’s possible generate objects without the class attribute, by using <code>class=FALSE</code>:</p>
<pre class="r"><code>R6NoClass &lt;- R6Class(&quot;R6NoClass&quot;,
  class = FALSE,
  public = list(
    x = NULL,
    initialize = function(x = 1) self$x &lt;- x,
    getx = function() self$x,
    inc = function(n = 1) self$x &lt;- self$x + n
  )
)</code></pre>
<p>Note that without the class attribute, S3 method dispatch on the objects is not possible.</p>
</div>
<div id="r6-class-non-portable" class="section level2">
<h2>R6 class, non-portable</h2>
<p>By default, R6 objects are <em>portable</em>. This means that inheritance can be in classes that are in different packages. However, it also requires the use of <code>self$</code> and <code>private$</code> to access members, and this incurs a small performance penalty.</p>
<p>If <code>portable=FALSE</code> is used, members can be accessed without using <code>self$</code>, and assignment can be done with <code>&lt;&lt;-</code>:</p>
<pre class="r"><code>R6NonPortable &lt;- R6Class(&quot;R6NonPortable&quot;,
  portable = FALSE,
  public = list(
    x = NULL,
    initialize = function(value = 1) x &lt;&lt;- value,
    getx = function() x,
    inc = function(n = 1) x &lt;&lt;- x + n
  )
)</code></pre>
</div>
<div id="r6-class-without-class-attribute-and-non-portable" class="section level2">
<h2>R6 class, without class attribute, and non-portable</h2>
<p>For comparison, we’ll use a an R6 class without a class attribute, and which is non-portable.</p>
<pre class="r"><code>R6NoClassNonPortable &lt;- R6Class(&quot;R6NoClassNonPortable&quot;,
  portable = FALSE,
  class = FALSE,
  public = list(
    x = NULL,
    initialize = function(value = 1) x &lt;&lt;- value,
    getx = function() x,
    inc = function(n = 1) x &lt;&lt;- x + n
  )
)</code></pre>
</div>
<div id="r6-class-with-public-and-private-members" class="section level2">
<h2>R6 class, with public and private members</h2>
<p>This is a variant of the previous type of reference class, but this version has public and private members.</p>
<pre class="r"><code>R6Private &lt;- R6Class(&quot;R6Private&quot;,
  private = list(x = NULL),
  public = list(
    initialize = function(x = 1) private$x &lt;- x,
    getx = function() private$x,
    inc = function(n = 1) private$x &lt;- private$x + n
  )
)</code></pre>
<p>Instead of a single <code>self</code> object which refers to all items in an object, these objects have <code>self</code> (which refers to the public items) and <code>private</code>.</p>
<pre class="r"><code>R6Private$new()
#&gt; &lt;R6Private&gt;
#&gt;   Public:
#&gt;     getx: function
#&gt;     inc: function
#&gt;     initialize: function</code></pre>
</div>
<div id="r6-class-with-public-and-private-members-no-class-attribute-and-non-portable" class="section level2">
<h2>R6 class, with public and private members, no class attribute, and non-portable</h2>
<p>For comparison, we’ll add a version without a class attribute, and which is non-portable.</p>
<pre class="r"><code>R6PrivateNcNp &lt;- R6Class(&quot;R6PrivateNcNp&quot;,
  portable = FALSE,
  class = FALSE,
  private = list(x = NULL),
  public = list(
    initialize = function(x = 1) private$x &lt;- x,
    getx = function() x,
    inc = function(n = 1) x &lt;&lt;- x + n
  )
)</code></pre>
</div>
<div id="environment-created-by-a-closure-with-class-attribute" class="section level2">
<h2>Environment created by a closure, with class attribute</h2>
<p>In R, environments are passed by reference. A simple way to create an object that’s passed by reference is to use the environment created by the invocation of a function. The function below captures that environment, attaches a class to it, and returns it:</p>
<pre class="r"><code>ClosureEnvClass &lt;- function(x = 1) {
  inc &lt;- function(n = 1) x &lt;&lt;- x + n
  getx &lt;- function() x
  self &lt;- environment()
  class(self) &lt;- &quot;ClosureEnvClass&quot;
  self
}</code></pre>
<p>Even though <code>x</code> isn’t declared in the function body, it gets captured because it’s an argument to the function.</p>
<pre class="r"><code>ls(ClosureEnvClass())
#&gt; [1] &quot;getx&quot; &quot;inc&quot;  &quot;self&quot; &quot;x&quot;</code></pre>
<p>Objects created this way are very similar to those created by <code>R6</code> generator we created above.</p>
</div>
<div id="environment-created-by-a-closure-without-class-attribute" class="section level2">
<h2>Environment created by a closure, without class attribute</h2>
<p>We can make an even simpler type of reference object to the previous one, by not having a a class attribute, and not having <code>self</code> object:</p>
<pre class="r"><code>ClosureEnvNoClass &lt;- function(x = 1) {
  inc &lt;- function(n = 1) x &lt;&lt;- x + n
  getx &lt;- function() x
  environment()
}</code></pre>
<p>This is simply an environment with some objects in it.</p>
<pre class="r"><code>ls(ClosureEnvNoClass())
#&gt; [1] &quot;getx&quot; &quot;inc&quot;  &quot;x&quot;</code></pre>
<hr />
</div>
</div>
<div id="tests" class="section level1">
<h1>Tests</h1>
<p>For all the timings using <code>microbenchmark()</code>, the results are reported in microseconds, and the most useful value is probably the median column.</p>
<div id="memory-footprint" class="section level2">
<h2>Memory footprint</h2>
<p>How much memory does a single instance of each object take, and how much memory does each additional object take? We’ll use the functions <code>obj_size</code> and <code>obj_sizes</code> (shown at the bottom of this document) to calculate the sizes.</p>
<p>Sizes of each type of object, in bytes:</p>
<pre class="r"><code>sizes &lt;- obj_sizes(
  RC$new(),
  R6$new(),
  R6NoClass$new(),
  R6NonPortable$new(),
  R6NoClassNonPortable$new(),
  R6Private$new(),
  R6PrivateNcNp$new(),
  ClosureEnvClass(),
  ClosureEnvNoClass()
)
sizes
#&gt;                               one incremental
#&gt; RC$new()                   472072        1368
#&gt; R6$new()                    12624         840
#&gt; R6NoClass$new()             13328         728
#&gt; R6NonPortable$new()         12160         784
#&gt; R6NoClassNonPortable$new()  12408         672
#&gt; R6Private$new()             13584         952
#&gt; R6PrivateNcNp$new()         13344         784
#&gt; ClosureEnvClass()           10696         624
#&gt; ClosureEnvNoClass()          9288         512</code></pre>
<p>The results are plotted below. Note that the plots have very different x scales.</p>
<p><img src="data:image/png;base64,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" /> <img src="data:image/png;base64,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" /></p>
<p>It looks like using a reference class takes up a huge amount of memory, but much of that is shared between reference classes. Adding an object from a different reference class doesn’t require much more memory — around 38KB:</p>
<pre class="r"><code>RC2 &lt;- setRefClass(&quot;RC2&quot;,
  fields = list(x = &quot;numeric&quot;),
  methods = list(
    initialize = function(x = 2) .self$x &lt;&lt;- x,
    inc = function(n = 2) x &lt;&lt;- x * n
  )
)

# Calcualte the size of a new RC2 object, over and above an RC object
as.numeric(object_size(RC$new(), RC2$new()) - object_size(RC$new()))
#&gt; [1] 37752</code></pre>
</div>
<div id="object-instantiation-speed" class="section level2">
<h2>Object instantiation speed</h2>
<p>How much time does it take to create one of these objects? This shows the median time, in microseconds:</p>
<pre class="r"><code># Function to extract the medians from microbenchmark results
mb_summary &lt;- function(x) {
  res &lt;- summary(x, unit=&quot;us&quot;)
  data.frame(name = res$expr, median = res$median)
}

speed &lt;- microbenchmark(
  RC$new(),
  R6$new(),
  R6NoClass$new(),
  R6NonPortable$new(),
  R6NoClassNonPortable$new(),
  R6Private$new(),
  R6PrivateNcNp$new(),
  ClosureEnvClass(),
  ClosureEnvNoClass()
)
speed &lt;- mb_summary(speed)
speed
#&gt;                         name   median
#&gt; 1                   RC$new() 377.0455
#&gt; 2                   R6$new()  56.9860
#&gt; 3            R6NoClass$new()  46.4555
#&gt; 4        R6NonPortable$new()  54.4795
#&gt; 5 R6NoClassNonPortable$new()  43.3780
#&gt; 6            R6Private$new()  76.7895
#&gt; 7        R6PrivateNcNp$new()  64.9745
#&gt; 8          ClosureEnvClass()   3.7705
#&gt; 9        ClosureEnvNoClass()   1.7730</code></pre>
<p>The plot below shows the median instantiation time.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>R reference classes are much slower to instantiate than the other types of classes. Instantiating R6 objects is roughly 10 times faster. Creating an environment with a simple closure is another 10-20 times faster still.</p>
</div>
<div id="field-access-speed" class="section level2">
<h2>Field access speed</h2>
<p>How much time does it take to access a field in an object? First we’ll make some objects:</p>
<pre class="r"><code>rc           &lt;- RC$new()
r6           &lt;- R6$new()
r6nc         &lt;- R6NoClass$new()
r6np         &lt;- R6NonPortable$new()
r6nc_np      &lt;- R6NoClassNonPortable$new()
r6priv       &lt;- R6Private$new()
r6priv_nc_np &lt;- R6PrivateNcNp$new()
closure      &lt;- ClosureEnvClass()
closure_nc   &lt;- ClosureEnvNoClass()</code></pre>
<p>And then get a value from these objects:</p>
<pre class="r"><code>speed &lt;- microbenchmark(
  rc$x,
  r6$x,
  r6nc$x,
  r6np$x,
  r6nc_np$x,
  r6priv$x,
  r6priv_nc_np$x,
  closure$x,
  closure_nc$x
)
speed &lt;- mb_summary(speed)
speed
#&gt;             name  median
#&gt; 1           rc$x 12.8565
#&gt; 2           r6$x  2.8815
#&gt; 3         r6nc$x  0.3295
#&gt; 4         r6np$x  3.1125
#&gt; 5      r6nc_np$x  0.3260
#&gt; 6       r6priv$x  3.1055
#&gt; 7 r6priv_nc_np$x  0.3385
#&gt; 8      closure$x  2.4540
#&gt; 9   closure_nc$x  0.3485</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>Accessing the field of a reference class is much slower than the other methods.</p>
<p>There’s also an obvious pattern where accessing the field of an environment (created by R6 or a closure) is slower when there is a class attribute. This is because, for the objects that have a class attribute, R attempts to look up an S3 method for <code>$</code>, and this lookup has a performance penalty, as we’ll see below.</p>
</div>
<div id="field-setting-speed" class="section level2">
<h2>Field setting speed</h2>
<p>How much time does it take to set the value of a field in an object?</p>
<pre class="r"><code>speed &lt;- microbenchmark(
  rc$x &lt;- 4,
  r6$x &lt;- 4,
  r6nc$x &lt;- 4,
  r6np$x &lt;- 4,
  r6nc_np$x &lt;- 4,
  # r6priv$x &lt;- 4,         # Can't set private field directly,
  # r6priv_nc_np$x &lt;- 4,   # so we'll skip these two
  closure$x &lt;- 4,
  closure_nc$x &lt;- 4
)
speed &lt;- mb_summary(speed)
speed
#&gt;                name  median
#&gt; 1         rc$x &lt;- 4 55.7430
#&gt; 2         r6$x &lt;- 4  3.5055
#&gt; 3       r6nc$x &lt;- 4  0.9755
#&gt; 4       r6np$x &lt;- 4  3.8320
#&gt; 5    r6nc_np$x &lt;- 4  0.9925
#&gt; 6    closure$x &lt;- 4  3.1355
#&gt; 7 closure_nc$x &lt;- 4  0.9535</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>Reference classes are significantly slower than the others, again. In this case, there’s additional overhead due to type-checking the value.</p>
<p>Once more, the no-class objects are significantly faster than the others, again probably due to attempted S3 dispatch on the <code>`$&lt;-`</code> function.</p>
</div>
<div id="speed-of-method-call-that-accesses-a-field" class="section level2">
<h2>Speed of method call that accesses a field</h2>
<p>How much overhead is there when calling a method from one of these objects? All of these <code>getx()</code> methods simply return the value of <code>x</code> in the object. When necessary, this method uses <code>self$x</code> (for R6 classes, when <code>portable=TRUE</code>), and in others, it just uses <code>x</code> (when <code>portable=FALSE</code>, and in reference classes).</p>
<pre class="r"><code>speed &lt;- microbenchmark(
  rc$getx(),
  r6$getx(),
  r6nc$getx(),
  r6np$getx(),
  r6nc_np$getx(),
  r6priv$getx(),
  r6priv_nc_np$getx(),
  closure$getx(),
  closure_nc$getx()
)
speed &lt;- mb_summary(speed)
speed
#&gt;                  name  median
#&gt; 1           rc$getx() 21.6015
#&gt; 2           r6$getx()  9.8505
#&gt; 3         r6nc$getx()  1.4525
#&gt; 4         r6np$getx()  5.5735
#&gt; 5      r6nc_np$getx()  0.9170
#&gt; 6       r6priv$getx()  5.9810
#&gt; 7 r6priv_nc_np$getx()  0.9830
#&gt; 8      closure$getx()  4.4595
#&gt; 9   closure_nc$getx()  0.9415</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>The reference class is the slowest.</p>
<p><code>r6</code> is also somewhat slower than the others. There are two reasons for this: first, it uses <code>self$x</code> which adds some time, and second, it has a class attribute, which slows down the access of both <code>r6$getx</code> and <code>self$x</code>.</p>
<p>One might expect <code>r6priv</code> to be the same speed as <code>r6</code>, but it is faster. Although accessing <code>r6priv$getx</code> is slow, because <code>r6priv</code> has a class attribute, accessing <code>private$x</code> is faster, because it does not have a class attribute.</p>
<p>The objects which can access <code>x</code> directly (without <code>self</code> or <code>private</code>) and which lack a class attribute are the fastest.</p>
</div>
<div id="assignment-using-selfx---vs.-x--" class="section level2">
<h2>Assignment using <code>self$x &lt;-</code> vs. <code>x &lt;&lt;-</code></h2>
<p>With reference class objects, you can modify fields using the <code>&lt;&lt;-</code> operator, or by using the <code>.self</code> object. For example, compare the <code>setx()</code> methods of these two classes:</p>
<pre class="r"><code>RCself &lt;- setRefClass(&quot;RCself&quot;,
  fields = list(x = &quot;numeric&quot;),
  methods = list(
    initialize = function() .self$x &lt;- 1,
    setx = function(n = 2) .self$x &lt;- n
  )
)

RCnoself &lt;- setRefClass(&quot;RCnoself&quot;,
  fields = list(x = &quot;numeric&quot;),
  methods = list(
    initialize = function() x &lt;&lt;- 1,
    setx = function(n = 2) x &lt;&lt;- n
  )
)</code></pre>
<p>Non-portable R6 classes are similar, except they use <code>self</code> instead of <code>.self</code>:</p>
<pre class="r"><code>R6self &lt;- R6Class(&quot;R6self&quot;,
  portable = FALSE,
  public = list(
    x = 1,
    setx = function(n = 2) self$x &lt;- n
  )
)

R6noself &lt;- R6Class(&quot;R6noself&quot;,
  portable = FALSE,
  public = list(
    x = 1,
    setx = function(n = 2) x &lt;&lt;- n
  )
)</code></pre>
<pre class="r"><code>rc_self   &lt;- RCself$new()
rc_noself &lt;- RCnoself$new()
r6_self   &lt;- R6self$new()
r6_noself &lt;- R6noself$new()

speed &lt;- microbenchmark(
  rc_self$setx(),
  rc_noself$setx(),
  r6_self$setx(),
  r6_noself$setx()
)
speed &lt;- mb_summary(speed)
speed
#&gt;               name  median
#&gt; 1   rc_self$setx() 64.4125
#&gt; 2 rc_noself$setx() 40.2150
#&gt; 3   r6_self$setx()  8.3895
#&gt; 4 r6_noself$setx()  3.7210</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>For both reference and non-portable R6 classes, assignment using <code>.self$x &lt;-</code> is somewhat slower than using <code>x &lt;&lt;-</code>.</p>
<p>Bear in mind that, by default, R6 classes are portable, and can’t use assignment with <code>x &lt;&lt;-</code>.</p>
</div>
<div id="overhead-from-using-on-objects-with-a-class-attribute" class="section level2">
<h2>Overhead from using <code>$</code> on objects with a class attribute</h2>
<p>There is some overhead when using <code>$</code> on an object that has a class attribute. In the test below, we’ll create three different kinds of objects:</p>
<ol style="list-style-type: decimal">
<li>An environment with no class attribute.</li>
<li>An environment with a class <code>&quot;e2&quot;</code>, but without a <code>$.e2</code> S3 method.</li>
<li>An environment with a class <code>&quot;e3&quot;</code>, which has a <code>$.e3</code> S3 method that simply returns <code>NULL</code>.</li>
</ol>
<p>Each one of these environments will contain an object <code>x</code>.</p>
<pre class="r"><code>e1 &lt;- new.env(hash = FALSE, parent = emptyenv())
e2 &lt;- new.env(hash = FALSE, parent = emptyenv())
e3 &lt;- new.env(hash = FALSE, parent = emptyenv())

e1$x &lt;- 1
e2$x &lt;- 1
e3$x &lt;- 1

class(e2) &lt;- &quot;e2&quot;
class(e3) &lt;- &quot;e3&quot;

# Define an S3 method for class e3
`$.e3` &lt;- function(x, name) {
  NULL
}</code></pre>
<p>Now we can run timing tests for calling <code>$</code> on each type of object. Note that for the <code>e3</code> object, the <code>$</code> function does nothing — it simply returns <code>NULL</code>.</p>
<pre class="r"><code>speed &lt;- microbenchmark(
  e1$x,
  e2$x,
  e3$x
)
speed &lt;- mb_summary(speed)
speed
#&gt;   name median
#&gt; 1 e1$x  0.267
#&gt; 2 e2$x  2.051
#&gt; 3 e3$x  1.613</code></pre>
<p>Using <code>$</code> on <code>e2</code> and <code>e3</code> is much slower than on <code>e1</code>. This is because <code>e2</code> and <code>e3</code> have a class attribute. Even though there’s no <code>$</code> method defined for <code>e2</code>, doing <code>e2$x</code> still about 6 times slower than <code>e1$x</code>, simply because R looks for an appropriate S3 method.</p>
<p><code>e3$x</code> is slightly faster than <code>e2$x</code>; this is probably because the <code>$.e3</code> function doesn’t actually do anything other than return NULL.</p>
<p>If an object has a class attribute, R will attempt to look for a method every time <code>$</code> is called. This can slow things down considerably, if <code>$</code> is used often.</p>
</div>
<div id="lists-vs.environments-and-vs." class="section level2">
<h2>Lists vs. environments, and <code>$</code> vs. <code>[[</code></h2>
<p>Lists could also be used for creating classes. How much time does it take to access items using <code>$</code> for lists vs. environments? We’ll also compare using <code>obj$x</code> to <code>obj[['x']]</code>.</p>
<pre class="r"><code>lst &lt;- list(x = 10)
env &lt;- new.env()
env$x &lt;- 10

mb_summary(microbenchmark(
  lst = lst$x,
  env = env$x,
  lst[['x']],
  env[['x']]
))
#&gt;         name median
#&gt; 1        lst 0.3085
#&gt; 2        env 0.2810
#&gt; 3 lst[[&quot;x&quot;]] 0.2195
#&gt; 4 env[[&quot;x&quot;]] 0.2105</code></pre>
<p>Performance is comparable across environments and lists.</p>
<p>The <code>[[</code> operator is slightly faster than <code>$</code>, probably because it doesn’t need to convert the unevaluated symbol to a string.</p>
<hr />
</div>
</div>
<div id="wrap-up" class="section level1">
<h1>Wrap-up</h1>
<p>R6 objects take less memory and are significantly faster than R’s reference class objects, and they also have some options that provide for even more speed.</p>
<p>In these tests, the biggest speedup for R6 classes comes from not using a class attribute; this speeds up the use of <code>$</code>. Non-portable R6 classes can also access fields without <code>$</code> at all, which provides another modest speed boost. In most cases, these speed increases are negligible – they are on the order of microseconds and will be noticeable only when tens or even hundreds of thousands of class member accesses are performed.</p>
<hr />
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="functions-for-calculating-object-sizes" class="section level2">
<h2>Functions for calculating object sizes</h2>
<pre class="r"><code># Utility functions for calculating sizes
obj_size &lt;- function(expr, .env = parent.frame()) {
  size_n &lt;- function(n = 1) {
    objs &lt;- lapply(1:n, function(x) eval(expr, .env))
    as.numeric(do.call(object_size, objs))
  }

  data.frame(one = size_n(1), incremental = size_n(2) - size_n(1))
}

obj_sizes &lt;- function(..., .env = parent.frame()) {
  exprs &lt;- as.list(match.call(expand.dots = FALSE)$...)
  names(exprs) &lt;- lapply(1:length(exprs),
    FUN = function(n) {
      name &lt;- names(exprs)[n]
      if (is.null(name) || name == &quot;&quot;) paste(deparse(exprs[[n]]), collapse = &quot; &quot;)
      else name
    })

  sizes &lt;- mapply(obj_size, exprs, MoreArgs = list(.env = .env), SIMPLIFY = FALSE)
  do.call(rbind, sizes)
}</code></pre>
</div>
<div id="system-information" class="section level2">
<h2>System information</h2>
<pre class="r"><code>sessionInfo()
#&gt; R version 3.1.1 (2014-07-10)
#&gt; Platform: x86_64-pc-linux-gnu (64-bit)
#&gt; 
#&gt; locale:
#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C              
#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] scales_0.2.4         ggplot2_1.0.0        pryr_0.1            
#&gt; [4] microbenchmark_1.4-2 R6_2.0.1            
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] MASS_7.3-35      Rcpp_0.11.3      codetools_0.2-9  colorspace_1.2-4
#&gt;  [5] digest_0.6.4     evaluate_0.5.5   formatR_1.0      grid_3.1.1      
#&gt;  [9] gtable_0.1.2     htmltools_0.2.6  knitr_1.7        labeling_0.3    
#&gt; [13] munsell_0.4.2    plyr_1.8.1       proto_0.3-10     reshape2_1.4    
#&gt; [17] rmarkdown_0.3.10 stringr_0.6.2    tools_3.1.1      yaml_2.1.13</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
